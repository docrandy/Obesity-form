<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Patient Intake Form</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to external CSS -->
    <script src="scripts.js" defer></script> <!-- Link to external JS -->
</head>
<body>
    <div class="form-container">
        <!-- Progress Bar -->
        <div id="progressBar">
            <div id="progress" style="width: 0%;">0%</div>
        </div>

        <form id="patientForm" onsubmit="submitForm(event)">

            <!-- Page 1: Patient Demographics -->
            <div class="form-page" id="page-1">
                <h2>Patient Demographics</h2>
                <label>Full Name:<input type="text" name="fullName" required></label>
                <label>Date of Birth:<input type="date" name="dob" required></label>
                <label>Address:<input type="text" name="address" required></label>
                <label>Gender:
                    <select name="gender" required>
                        <option value="">Select</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </label>
                <label>Phone Number:<input type="tel" name="phone" required></label>
                <label>Email Address:<input type="email" name="email" required></label>
                <button type="button" onclick="nextPage()">Next</button>
            </div>

            <!-- Page 2: Preferred Pharmacy -->
            <div class="form-page" id="page-2">
                <h2>Preferred Pharmacy</h2>
                <label>Pharmacy Name:<input type="text" name="pharmacy" list="pharmacyList" required></label>
                <datalist id="pharmacyList"></datalist> <!-- Use a JavaScript library for auto-fill -->
                <label>Pharmacy Phone Number:<input type="tel" name="pharmacyPhone" required></label>
                <button type="button" onclick="nextPage()">Next</button>
            </div>

            <!-- Page 3: Allergies -->
            <div class="form-page" id="page-3">
                <h2>Allergies</h2>
                <label>Do you have any allergies?
                    <select name="allergies" onchange="toggleAllergyFields(this.value)">
                        <option value="">Select</option>
                        <option value="No">No</option>
                        <option value="Yes">Yes</option>
                    </select>
                </label>
                <div id="allergyFields" style="display: none;">
                    <label>Allergy Name:<input type="text" name="allergyName[]"></label>
                    <label>Reaction:<input type="text" name="reaction[]"></label>
                    <button type="button" onclick="addField('allergyFields')">Add More</button>
                </div>
                <button type="button" onclick="nextPage()">Next</button>
            </div>

            <!-- Page 4: Medications -->
            <div class="form-page" id="page-4">
                <h2>Medications</h2>
                <label>Are you currently taking any medications?
                    <select name="takingMeds" onchange="toggleMedFields(this.value)">
                        <option value="">Select</option>
                        <option value="No">No</option>
                        <option value="Yes">Yes</option>
                    </select>
                </label>
                <div id="medFields" style="display: none;">
                    <label>Medication Name:<input type="text" name="medName[]"></label>
                    <label>Dosage:<input type="text" name="dosage[]"></label>
                    <label>Frequency:<input type="text" name="frequency[]"></label>
                    <button type="button" onclick="addField('medFields')">Add More</button>
                </div>
                <button type="button" onclick="nextPage()">Next</button>
            </div>

            <!-- Page 5: Lifestyle History -->
            <div class="form-page" id="page-5">
                <h2>Smoking, Alcohol, Recreational Drugs</h2>
                <label>Smoking Status:
                    <select name="smokingStatus" required>
                        <option value="">Select</option>
                        <option value="Never">Never</option>
                        <option value="Current">Current</option>
                        <option value="Former">Former</option>
                    </select>
                </label>
                <label>Alcohol Use:
                    <select name="alcoholUse" required>
                        <option value="">Select</option>
                        <option value="Never">Never</option>
                        <option value="Occasionally">Occasionally</option>
                        <option value="Daily">Daily</option>
                    </select>
                </label>
                <label>Recreational Drugs:
                    <select name="recDrugs" required>
                        <option value="">Select</option>
                        <option value="Never">Never</option>
                        <option value="Past">Past</option>
                        <option value="Current">Current</option>
                    </select>
                </label>
                <button type="button" onclick="nextPage()">Next</button>
            </div>

            <!-- Other Pages as per previous structure -->

            <!-- Final Page: Signature and Submit -->
            <div class="form-page" id="page-final">
                <h2>Consent and Signature</h2>
                <label>Signature:
                    <input type="text" name="signature" required placeholder="Type your name">
                </label>
                <p>Date: <span id="timestamp"></span></p>
                <button type="submit">Submit</button>
            </div>
        </form>
    </div>

    <script>
        let currentPage = 0;
        const pages = document.querySelectorAll('.form-page');
        const progress = document.getElementById('progress');

        // Progress function
        function updateProgress() {
            let progressValue = ((currentPage + 1) / pages.length) * 100;
            progress.style.width = progressValue + '%';
            progress.textContent = Math.round(progressValue) + '%';
        }

        // Move to the next page
        function nextPage() {
            pages[currentPage].style.display = 'none';
            currentPage++;
            pages[currentPage].style.display = 'block';
            updateProgress();
        }

        // Toggle Allergy and Med fields
        function toggleAllergyFields(value) {
            document.getElementById('allergyFields').style.display = value === 'Yes' ? 'block' : 'none';
        }

        function toggleMedFields(value) {
            document.getElementById('medFields').style.display = value === 'Yes' ? 'block' : 'none';
        }

        // Add more fields function
        function addField(containerId) {
            const container = document.getElementById(containerId);
            const newField = container.firstElementChild.cloneNode(true);
            container.appendChild(newField);
        }

        // Set Timestamp
        document.getElementById('timestamp').textContent = new Date().toLocaleString();

        // Submit form to Google Sheet (Use a backend API in production for HIPAA compliance)
        function submitForm(event) {
            event.preventDefault();
            alert('Form Submitted!'); // Replace with form submission logic
        }

        // Initial load
        pages.forEach((page, index) => {
            if (index !== 0) page.style.display = 'none';
        });
        updateProgress();
    </script>
</body>
</html>
